<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>백억지도</title>
  <link rel="icon" type="image/png" href="https://sfinbtiqlfnaaarziixu.supabase.co/storage/v1/object/public/baikuk-images-open/pabicon-baikuk-simbol.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Kakao Maps -->
  <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f605c7b72dc7f3083f36483e55e2bc77&libraries=clusterer"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- LightGallery CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery/css/lightgallery.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery/css/lg-zoom.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery/css/lg-thumbnail.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery/css/lg-fullscreen.css">

  <!-- LightGallery JS -->
  <script src="https://cdn.jsdelivr.net/npm/lightgallery/lightgallery.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery/plugins/zoom/lg-zoom.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery/plugins/thumbnail/lg-thumbnail.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lightgallery/plugins/fullscreen/lg-fullscreen.umd.js"></script>

  <style>
    :root {
      --header-height: 3.5rem;
      --infopanel-left: 23.5%;
      --header-button-height: 1.6rem !important;
    }
    body { margin: 0; padding: 0; }
    header { position: fixed; top: 0; left: 0; right: 0; height: var(--header-height); z-index: 10000; background: #fff; }
    #map { position: absolute; top: var(--header-height); left: var(--infopanel-left); right: 0; bottom: 0; z-index: 0; }
    #info-panel { position: absolute; top: var(--header-height); left: 0; width: var(--infopanel-left); bottom: 0; z-index: 50; background: #fff; }
    #detail-panel { position: absolute; top: var(--header-height); left: var(--infopanel-left); width: 26%; bottom: 0; z-index: 9999; border-left: 0.3rem solid #e5e7eb; background:#fff; }
    #filter-bar { display: flex; flex-direction: column; gap: 2px; margin-top: 0; }
    header button {
      height: var(--header-button-height);
      font-size: 0.8rem !important;
      display: flex;
      align-items: center;
      padding-top: 0;
      padding-bottom: 0;
    }
    /* 워터마크 오버레이 */
    .wm-white{
      position:absolute; inset:0; pointer-events:none; user-select:none;
      background:#fff; opacity:.40;
      -webkit-mask-repeat:no-repeat; mask-repeat:no-repeat;
      -webkit-mask-position:center; mask-position:center;
      -webkit-mask-size: var(--wm-size, 360px) auto;
              mask-size: var(--wm-size, 360px) auto;
    }
    .thumb-box { background:#f3f4f6; overflow:hidden; }
    .thumb-img { width:100%; height:100%; object-fit: cover; object-position:center; }
    .thumb-img-cover { width:100%; height:100%; object-fit: cover; object-position:center; }
    .thumb-img-contain { width:100%; height:100%; object-fit: cover; object-position:center; }
    .no-save {
      -webkit-user-drag: none;
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      -webkit-touch-callout: none;
    }
  </style>
</head>
<body class="m-0 p-0">
  <!-- Header -->
  <header class="flex items-center gap-4 w-full px-4 bg-white shadow-md border-b border-gray-200 fixed top-0 left-0">
    <img
      src="https://sfinbtiqlfnaaarziixu.supabase.co/storage/v1/object/public/baikuk-images-open/logotype-baikuk.png"
      alt="글씨로고"
      class="h-11 w-auto cursor-pointer"
    />
    <div class="relative">
      <button
        id="filter-btn-init"
        data-default-label="초기화"
        class="ml-[100px] px-3 py-1.5 border border-gray-200 bg-red-100 text-red-600 rounded-md shadow-sm text-sm font-bold hover:bg-red-200 transition"
      >
        초기화
      </button>
    </div>

    <div id="filter-bar" class="flex flex-row gap-2 items-start mt-2 relative z-[1000]">
      <div id="btn-wrap" class="flex flex-row gap-2"></div>
    </div>

    <div id="filter-btns-wrap" class="flex gap-1"></div>

    <div style="flex:1"></div>
    <button id="logout-btn" class="hidden text-sm text-gray-600 hover:text-black border px-3 py-1 rounded">로그아웃</button>
  </header>

  <!-- Auth modal -->
  <div id="login-modal" class="fixed inset-0 z-[20000] bg-black/40 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg shadow-lg p-8 w-80">
      <h2 class="font-bold text-xl mb-4 text-center">직원 로그인</h2>
      <input id="login-email" type="email" placeholder="이메일" class="w-full border border-gray-300 rounded px-3 py-2 mb-3" />
      <input id="login-password" type="password" placeholder="비밀번호" class="w-full border border-gray-300 rounded px-3 py-2 mb-4" />
      <button id="login-submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 font-semibold">로그인</button>
      <button id="login-close" class="w-full text-gray-500 mt-2">닫기</button>
      <div id="login-error" class="text-red-600 text-sm mt-2 hidden"></div>
    </div>
  </div>
  <div id="loading-overlay" class="fixed inset-0 z-[30000] bg-black bg-opacity-40 flex items-center justify-center hidden">
    <div class="text-white text-xl font-bold">로그인 중입니다...</div>
  </div>

  <!-- Map & Panels -->
  <div id="map"></div>

  <div id="info-panel" class="overflow-y-auto bg-white shadow-xl p-3 text-sm hidden">
    <div id="info-content" class="text-xs text-gray-700"></div>
  </div>

  <div id="detail-panel" class="hidden">
    <button
      id="close-detail-btn"
      class="absolute top-2 right-4 w-8 h-8 bg-white text-gray-600 border border-gray-300 hover:border-black hover:text-black shadow-md flex items-center justify-center font-bold text-lg z-[1001]"
      aria-label="상세 닫기"
    >✕</button>
    <div id="detail-content" class="text-gray-800 text-sm whitespace-pre-line overflow-y-auto h-full px-4 pb-4"></div>
  </div>

  <!-- Map Controls -->
  <div id="map-controls" class="fixed z-[11000] flex flex-col items-center bottom-10 right-5">
    <button id="btn-naver-map" class="w-10 h-10 shadow rounded-lg flex items-center justify-center border border-gray-300 bg-[#00de5a] hover:bg-[#00b74a] transition mb-3 text-white text-[28px] font-black" title="네이버지도" style="text-shadow: 0 1px 2px #ffffff, 0 0 1px #ffffff;">N</button>
    <button id="btn-current-location" class="w-10 h-10 shadow rounded-lg flex items-center justify-center border border-gray-300 bg-white hover:bg-yellow-200 transition mb-5" title="현재 위치로 이동">
      <span class="text-xl text-black font-bold">◉</span>
    </button>
    <div class="flex flex-col space-y-1">
      <button id="btn-zoom-in" class="w-10 h-10 shadow rounded-lg flex items-center justify-center border border-gray-300 bg-white hover:bg-yellow-200 transition" title="확대">
        <span class="text-2xl text-black font-bold">＋</span>
      </button>
      <button id="btn-zoom-out" class="w-10 h-10 shadow rounded-lg flex items-center justify-center border border-gray-300 bg-white hover:bg-yellow-200 transition" title="축소">
        <span class="text-2xl text-black font-bold">－</span>
      </button>
    </div>
  </div>

  <!-- 모듈 엔트리포인트 -->
  <script type="module" src="./modules/main.js"></script>
</body>
</html>
